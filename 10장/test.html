<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>산수를 풀어 봅시다.</title>
	<style type="text/css">
		input {
			width: 100px;
		}
	</style>
</head>
<body onload="reset()">
<h3>산수 문제를 풀어 봅시다.</h3>
문제는 자동으로 생성되며, 10초가 지나면 자동 채점됩니다. <br>
남은 시간 <span id="time">10</span>
<hr>
<table>
	<tr>
		<td class="q"></td>
		<td><input class="a" type="text" name=""></td>
	</tr>
	<tr>
		<td class="q"></td>
		<td><input class="a" type="text" name=""></td>
	</tr>
	<tr>
		<td class="q"></td>
		<td><input class="a" type="text" name=""></td>
	</tr>
	<tr>
		<td class="q"></td>
		<td><input class="a" type="text" name=""></td>
	</tr>
	<tr>
		<td><button onclick="reset()">다시</button></td>
		<td><span id="score">0</span></td>
	</tr>
</table>

<script type="text/javascript">

	let qArray = document.getElementsByClassName("q"); // 문제
	let aArray = document.getElementsByClassName("a"); // 내가 쓴 답
	let timer; // 타이머 변수

	function answer() {
		let total = 0;		

		for(let i=0; i<qArray.length; i++) {
			let q = eval(qArray[i].innerHTML);
			let a = parseInt(aArray[i].value);
			if(q == a) {
				total += 1;
			}
			else {
				qArray[i].style.textDecoration = "line-through";
			}
		}
		document.getElementById("score").innerHTML = total;
	}

	function startTimer() {
		let time = 10;
		document.getElementById("time").innerHTML = time;
		timer = setInterval(function() {
			time -= 1;
			document.getElementById("time").innerHTML = time;
			if (time <= 0) {
				clearInterval(timer);
				answer();
			}
		}, 1000);
	}

	function reset() {
		clearInterval(timer); // 기존 타이머 초기화
		for(let i=0; i<qArray.length; i++) {
			let q1 = Math.floor(Math.random()*20+1);
			let q2 = Math.floor(Math.random()*20+1);
			let q3 = Math.floor(Math.random()*4);

			switch(q3) {
			case 0: 
				q3 = "+";
				break;

			case 1:
				q3 = "-";
				break;

			case 2:
				q3 = "*";
				break;

			case 3:
				q3 = "/";
				break;
			}

			qArray[i].innerHTML = q1 + q3 + q2;
			qArray[i].style.textDecoration = "none";

			aArray[i].value = "";
			document.getElementById("score").innerHTML = 0;
		}
		startTimer(); // 타이머 시작
	}

</script>
</body>
</html>
